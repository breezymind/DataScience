library(dplyr)
library(reshape2)
install.packages("reshape2")
library(dplyr)
install.packages("reshape2")
library(reshape2)
cust <- read.csv("customerDb.csv", stringsAsFactors=F)
head(cust)
basket <- read.csv("basketData.csv", stringsAsFactors=F)
head(basket);tail(basket)
str(basket)
library(reshape2)
library(dplyr)
cust <- read.csv("customerDb.csv", stringsAsFactors=F)
head(cust)
basket <- read.csv("basketData.csv", stringsAsFactors=F)
head(basket);tail(basket)
version
table(cust)
table(cust$city)
dim(cust)
head(cust)
table(cust$age)
table(cust$sex)
age <- function(x){
mod <- x$age / 10;
return(mod)
}
sapply(cust, age)
Getage <- function(x){
mod <- x$age / 10;
return(mod)
}
sapply(cust, Getage)
str(cust)
cust$age / 10
mod <- x$age / 10
cust$age / 10
Getage <- function(x){
mod <- round(x$age / 10,0) * 10
return(mod)
}
sapply(cust, Getage)
cust$age_group <- round(cust$age / 10,0) * 10
head(cust)
round(cust$age / 10,0)
cust$age_group <- floor(cust$age / 10,0) * 10
cust$age_group <- floor(cust$age / 10,0) * 10
cust$age_group <- floor(cust$age / 10) * 10
head(cust)
Getage <- function(x){
mod <- floor(x$age / 10) * 10
return(mod)
}
sapply(cust, Getage)
sapply(cust$age, Getage)
table(cust$age_group)
cust %>% group_by(sex,age_group)
%>% group_by(sex,age_group)
cust %>% group_by(sex,age_group)
summarize(N=n())
cust %>%
group_by(sex,age_group) %>%
summarize(N=n())
cust %>%
group_by(sex,age_group) %>%
summarize(N=n(), avg_age = mean(age)
)
cust %>%
group_by(sex,age_group) %>%
summarize(N=n(), avg_age = function(age) mean(age) + 1)          # 그룹화 한것의 갯수, 평균 나이.
tmp <- function(age) mean(age) + 1
cust %>%
group_by(sex,age_group) %>%
summarize(N=n(), avg_age = tmp)          # 그룹화 한것의 갯수, 평균 나이.
cust %>%
group_by(sex,age_group) %>%
summarize(N=n(), avg_age = tmp(age))          # 그룹화 한것의 갯수, 평균 나이.
cust %>%
group_by(sex,age_group) %>%
summarize(N=n(), avg_age = mean(age))          # 그룹화 한것의 갯수, 평균 나이.
cust %>%
group_by(sex,age_group) %>%
summarize(N=n(), avg_age = tmp(age))          # 그룹화 한것의 갯수, 평균 나이.
cust %>%
group_by(sex,age_group) %>%
summarize(N=n(), avg_age = function(age) mean(age) + 1 )          # 그룹화 한것의 갯수, 평균 나이.
cust %>%
group_by(sex,age_group) %>%
summarize(N=n(), avg_age = function(age){mean(age) + 1})          # 그룹화 한것의 갯수, 평균 나이.
tmp <- function(age) floor(mean(age)) + 1
cust %>%
group_by(sex,age_group) %>%
summarize(N=n(), avg_age = tmp(age))          # 그룹화 한것의 갯수, 평균 나이.
a <- cust %>%
group_by(sex,age_group) %>%
summarize(N=n(), avg_age = tmp(age))          # 그룹화 한것의 갯수, 평균 나이.
a
table(a$avg_age)
custage <- cust %>%
group_by(sex,age_group) %>%
summarize(N=n(), avg_age = tmp(age))          # 그룹화 한것의 갯수, 평균 나이.
custage
dcast(custage, sex ~ age_group, value.var = N, fun.aggregate = sum)
custage
dcast(custage, sex ~ age_group, value.var = "N", fun.aggregate = sum)
str(basket)
tmp <- basket
tmp$dummy <-1
a <- aggregate(dummy ~ custId + date, data = tmp, sum)
a
a <- a[order(a$custId, decreasing = T),]
a <- a[order(a$custId, decreasing = T),]
a
aggregate(dummy ~ custId, a, sum)
order(aggregate(dummy ~ custId, a, sum)$dummy, decreasing = T)
basket %>%
group_by(custId) %>%
summarize(ttl_amt=sum(amount)) %>%
arrange(desc(ttl_amt))
#Who are top 10 in purchase amount?
basket %>%
group_by(custId) %>%  # id로 그룹바이 하고 내용을 사용금액을 합. 나열.desc로
summarize(ttl_amt=sum(amount)) %>%
arrange(desc(ttl_amt))
basket %>%
group_by(custId) %>%
summarize(visit=n()) %>%
arrange(desc(visit))
basket %>%
group_by(custId,receiptNum) %>%
summarize(visit=n()) %>%
arrange(desc(visit))
basket %>%
group_by(custId,receiptNum) %>%
summarize(visit=n()) %>%
group_by(custId) %>%
summarize(visits=sum(visit))
arrange(desc(visits))
basket %>%
group_by(custId,receiptNum) %>%
summarize(visit=n()) %>%
group_by(custId) %>%
summarize(visits=sum(visit)) %>%
arrange(desc(visits))
basket %>%
group_by(custId,receiptNum) %>%
summarize(visit=n()) %>%
group_by(custId) %>%
summarize(visits=n() %>%
arrange(desc(visits))
basket %>%
group_by(custId,receiptNum) %>%
summarize(visit=n()) %>%
group_by(custId) %>%
summarize(visits=n()) %>%
arrange(desc(visits))
basket %>%
group_by(custId,receiptNum) %>%
summarize(visit=n()) %>%
group_by(custId) %>%
summarize(visits=n()) %>%
arrange(desc(visits))
basket %>%
group_by(time) %>%
summarize(amt=mean(amount)) %>%
arrange(desc(amt))
basket %>%
group_by(time) %>%
basket %>%
group_by(time)
basket %>%
group_by(time)
basket %>%
group_by(time) %>%
summarize(amt=sum(amount)) %>%
arrange(desc(amt))
dummy <- basket %>%
group_by(time, branchId) %>%
summarize(amt=mean(amount))
dummy
dummy1 <- dcast(dummy, time ~ branchId, fun.aggregate=sum, value.var="amt")
dummy1
args(dcast)
dummy2 <- dcast(dummy, branchId ~ time, fun.aggregate=sum, value.var="amt")
dummy2
class(dummy1)
branchHour <- as.data.frame(dummy1)
branchHour
dummy1 <- dcast(dummy, time ~ branchId, fun.aggregate=sum, value.var="amt")
dummy1
dummy2
branchHour2 <- as.data.frame(dummy2)
branchHour2
class(dummy1)
str(dummy1)
class(dummy)
tmp <- read.csv("ETC.csv", stringAsFactor = F)
tmp <- read.csv("ETC.csv", stringsAsFactors = F)
tmp
View(tmp)
library(dplyr)
tmp %>%
group_by(WHERE) %>%
summarize(N=n())
tmp %>%
group_by(WHERE,CATEGORY) %>%
summarize(N=n())
