insuracne <- read.csv("insurance.csv")
head(insuracne)
str(insuracne)
library(ggplot2)
ggplit(insuracne,aes(x=size,y=time,color=type)) + geom_point(size=3)
ggplot(insuracne,aes(x=size,y=time,color=type)) + geom_point(size=3)
cor(insuracne)
cor(insuracne$time,insuracne$size)
model1 <- lm(time~size+type,insuracne)
summary(model1)
formula <- as.formula("time~size+type")
model.matrix(formula)
model.matrix(time~size+type)
model.matrix("time~size+type")
model.matrix(time~size+type,insuracne)
model1$fitted.values
insuracne$fit = model1$fitted.values
gg <- ggplot(insuracne,aes(y=fit,x=size,group=type,color=type)) + geom_line()
gg + geom_point(aes(y=time,x=size,shape=type))
insuracne$type = relevel(insuracne$type,ref="stock")
insuracne$type = relevel(insuracne$type,ref="Stock")
model2 = lm(time ~ ., insuracne)
summary(model2)
model.matrix(time~size+type,insuracne)
model2.matrix(time~size+type,insuracne)
model.matrix(time~size+type,insuracne)
insuracne$fit = model2$fitted.values
gg <- ggplot(insuracne,aes(y=fit,x=size,group=type,color=type)) + geom_line()
gg + geom_point(aes(y=time,x=size,shape=type))
model3 = lm(time~.,insuracne,contrasts = list(type=contr.sum))
?lm
model3 = lm(time~.,insuracne,contrasts = list(type=contr.sum))
model.matrix(time~.,insuracne,contrasts = list(type=contr.sum))
insuracne <- insuracne[,-c(4)]
model3 = lm(time~.,insuracne,contrasts = list(type=contr.sum))
model.matrix(time~.,insuracne,contrasts = list(type=contr.sum))
contr.sum(5)
contr.sum(insuracne$type)
cdi <- read.csv("CDI.csv")
head(cdi)
insuracne$fit = model3$fitted.values
gg <- ggplot(insuracne,aes(y=fit,x=size,group=type,color=type)) + geom_line()
gg + geom_point(aes(y=time,x=size,shape=type))
insuracne$fit = model2$fitted.values
gg <- ggplot(insuracne,aes(y=fit,x=size,group=type,color=type)) + geom_line()
gg + geom_point(aes(y=time,x=size,shape=type))
insuracne$fit = model2$fitted.values
gg <- ggplot(insuracne,aes(y=fit,x=size,group=type,color=type)) + geom_line()
gg + geom_point(aes(y=time,x=size,shape=type))
insuracne <- insuracne[,-c(4)] # if there is fit_value, delete fit_value
model3 = lm(time~.,insuracne,contrasts = list(type=contr.sum))
insuracne$fit = model3$fitted.values
gg <- ggplot(insuracne,aes(y=fit,x=size,group=type,color=type)) + geom_line()
gg + geom_point(aes(y=time,x=size,shape=type))
insuracne$fit = model3$fitted.values
model.matrix(time~.,insuracne,contrasts = list(type=contr.sum))
contr.sum(insuracne$type)
insuracne$fit = model3$fitted.values
gg <- ggplot(insuracne,aes(y=fit,x=size,group=type,color=type)) + geom_line()
gg + geom_point(aes(y=time,x=size,shape=type))
df <- data.frame(m3 = model3$fitted.values, m2 = model2$fitted.values)
head(df)
cdi$region <- as.factor(cdi$region)
model_cdi <- lm(crime ~ pop + region, data=cdi)
model.matrix(crime ~ pop + region, data=cdi)
anova(model_cdi)
summary(model_cdi)
plot(model_cdi)
cdi[-6,]
cdi[6,]
cdi2 <- cdi[-6,]
model_cdi2 <- lm(crime ~ pop + region, data=cdi2)
summary(model_cdi2)
anova(model_cdi2)
model_cdi3 <- lm(crime ~ pop + region, data=cdi2, contrasts = list(region=contr.sum()))
model_cdi3 <- lm(crime ~ pop + region, data=cdi2, contrasts = list(region=contr.sum)
model_cdi3 <- lm(crime ~ pop + region, data=cdi2, contrasts = list(region=contr.sum))
model_cdi3 <- lm(crime ~ pop + region, data=cdi2, contrasts = list(region=contr.sum))
summary(model_cdi3)
cdi2$fit = model_cdi2$fitted.values
gg <- ggplot(cdi2,aes(x=pop,y=crime,color=region)) + geom_line()
gg + geom_point(aes(x=pop,y=crime,shape=region))
gg <- ggplot(cdi2,aes(x=pop,y=fit,color=region)) + geom_line()
gg + geom_point(aes(x=pop,y=crime,shape=region))
model_cdi4 <- lm(crime ~ pop+region+pop*region,data=cdi2)
summary(model_cdi4)
model4 <- lm(time ~ size+type + size*type,insuracne)
summary(model4)
anova(model4)
anova(model_cdi4)
model_cdi5 <- lm(crime~pop+unemployment+pop*unemployment,cdi2)
summary(model_cdi5)
