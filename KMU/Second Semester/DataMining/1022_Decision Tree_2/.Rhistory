install.packages("C50")
install.packages("caret")
install.packages("ROCR")
install.packages("C50")
install.packages("C50")
install.packages("caret")
install.packages("ROCR")
library(C50)
library(caret)
library(ROCR)
vb <- read.delim("Hshopping.txt",stringsAsFactors = F)
sb <- read.delim("Hshopping.txt",stringsAsFactors = F)
sb
head(sb)
str(sb)
View(vb)
rm(vb)
cb <- read.delim("Hshopping.txt",stringsAsFactors = F)
head(cb)
str(cb)
rm(sb)
cb$반품여부 <- as.factor(cb$반품여부)
str(cb)
summary(cb)
inTrain <- createDataPartition(y=cb$반품여부,p=0.6,list=F)
head(inTrain)
head(inTrain)
set.seed(1) # seed를 고정해야 동일한 샘플링을 가질 수 있다.
inTrain <- createDataPartition(y=cb$반품여부,p=0.6,list=F)
head(inTrain)
cb.train <- cb[inTrain,]
head(cb.train)
cb.test <- cb[-inTrain,]
head(cb.test)
dim(cb.test)
dim(cb.train)
c5_model <- c5.0(반품여부 ~ 성별+나이+구매금액+출연자, data=cb.train, control = c5_options, rules=F)
plot(c5_model)
c5_model <- c5.0(반품여부 ~ 성별+나이+구매금액+출연자, data=cb.train, control = c5_options, rules=F)
c5_model <- c5.0(반품여부 ~ 성별+나이+구매금액+출연자, data=cb.train, control = c5_options, rules=F)
c5_model <- C5.0(반품여부 ~ 성별+나이+구매금액+출연자, data=cb.train, control = c5_options, rules=F)
c5_options <- C5.0Control(winnow = F, noGlobalPruning = F)
c5_model <- C5.0(반품여부 ~ 성별+나이+구매금액+출연자, data=cb.train, control = c5_options, rules=F)
plot(c5_model)
summary(c5_model)
c5_model_2 <- C5.0(반품여부 ~ 성별+나이+구매금액+출연자, data=cb.train, control = c5_options, rules=T)
summary(c5_model_2)
c5_model_3 <- C5.0(반품여부 ~ 성별+나이+구매금액+출연자, data=cb.train, control = c5_options, rules=F, trials = 10)
summary(c5_model_3)
c5_model_3 <- C5.0(반품여부 ~ 성별+나이+구매금액+출연자, data=cb.train, control = c5_options, rules=T, trials = 10)
summary(c5_model_3)
c5_options_2 <- C5.0Control(winnow = F, noGlobalPruning = F, CF=0.7)
c5_model_4 <- C5.0(반품여부 ~ 성별+나이+구매금액+출연자, data=cb.train, control = c5_options_2, rules=T, trials = 10)
c5_model_4 <- C5.0(반품여부 ~ 성별+나이+구매금액+출연자, data=cb.train, control = c5_options_2, rules=T, c5_model_3 <- C5.0(반품여부 ~ 성별+나이+구매금액+출연자, data=cb.train, control = c5_options, rules=F)
)
c5_model_4 <- C5.0(반품여부 ~ 성별+나이+구매금액+출연자, data=cb.train, control = c5_options_2, rules=T, c5_model_3 <- C5.0(반품여부 ~ 성별+나이+구매금액+출연자, data=cb.train, control = c5_options, rules=F)
c5_model_4 <- C5.0(반품여부 ~ 성별+나이+구매금액+출연자, data=cb.train, control = c5_options_2, rules=F)
c5_options_2 <- C5.0Control(winnow = F, noGlobalPruning = F, CF=0.7)
c5_model_4 <- C5.0(반품여부 ~ 성별+나이+구매금액+출연자, data=cb.train, control = c5_options_2, rules=F)
summary(c5_model_4)
plot(c5_model_4)
cb.test$c5_pred <- predict(c5_model,cb.test,type="class")
head(cb.test)
confusionMatrix(cb.test[,6:7])
confusionMatrix(cb.test$반품여부, cb.test$c5_pred)
cb.test$c5_pred_prob <- predict(c5_model,cb.test,type="prob")
head(cb.test)
cb.test$c5_pred_prob <- round(predict(c5_model,cb.test,type="prob"),2)
head(cb.test)
confusionMatrix(cb.test$c5_pred, cb.test$반품여부)
c5_pred <- prediction(cb.test$c5_pred_prob[,2], cb.test$반품여부)
head(c5_pred)
summary(c5_pred)
c5_model.perf1 <- performance(c5_pred,"tpr","fpr") # Roc curve
c5_model.perf2 <- performance(c5_pred,"lift","rpp") # Lift chart
par(mfow=c(1,2))
?par
par(mfrow=c(1,2))
plot(c5_model.perf1,colorize=T)
plot(c5_model.perf2,colorize=T)
performance(c5_pred,"auc")@y.values[[1]]
install.packages("Epi")
library(Epi)
library(psych)
pairs.panels(cb.test)
pairs.panels(cb)
install.packages("C50")
install.packages("caret")
install.packages("ROCR")
library(C50)
library(caret)
library(ROCR)
2_group <- read.csv("2_group.csv", stringsAsFactors = F)
user <- read.csv("2_group.csv", stringsAsFactors = F)
head(user)
summary(user)
head(user)
is.null(user$birth)
user <- read.csv("2_group.csv", stringsAsFactors = T)
summary(user)
library(psych)
pairs.panels(user)
library(C50)
library(caret)
library(ROCR)
library(psych)
library(plyr)
user <- read.csv("2_group.csv", stringsAsFactors = T)
user <- user[,-c(3,4)]
user <- user[,-4]
user_tree <- user[,c(1:8,19,27,34:length(user))]
job <- read.delim("HDS_Jobs.tab",stringsAsFactors = T)
# 0 : 무효 1 : 남성 2: 여
user_tree = join(user_tree,job,by="job_stype")
user_tree <- user_tree[,-(length(user_tree)-1)]
user_tree <- user_tree[,-20]
user_tree <- user_tree[user_tree$sex!=0,] #무효는 제외
user_tree$sex <- factor(user_tree$sex)
user_tree$hobby <- factor(user_tree$hobby)
user_tree$job_stype <- factor(user_tree$job_stype)
user_tree$mail_flg <- factor(user_tree$mail_flg)
user_tree$h_type2 <- factor(user_tree$h_type2)
user_tree$card_flg1 <- factor(user_tree$card_flg1)
user_tree$mrg_flg <- factor(user_tree$mrg_flg)
user_tree$cus_stype <- factor(user_tree$cus_stype)
user_tree$agegrp <- factor(user_tree$agegrp)
set.seed(1)
inTrain <- createDataPartition(y=user_tree$sex,p=0.6,list=F)
user.train <- user_tree[inTrain,]
user.test <- user_tree[-inTrain,]
dim(user.test)
dim(user.train)
c5_options <- C5.0Control(winnow = T, noGlobalPruning = F)
c5_options <- C5.0Control(winnow = F, noGlobalPruning = F)
write.csv(user_tree,"user_tree.csv")
c5_options <- C5.0Control(winnow = F, noGlobalPruning = F)
head(user.train)
c5_model <- C5.0(sex ~ mrg_flg+h_type1+h_type2+hobby+cus_stype+fav_time+fav_part+job_nm_gr, data=user.train[,-1], control = c5_options, rules=F)
summary(c5_model)
c5_model <- C5.0(sex ~ mrg_flg+h_type1+h_type2+hobby+cus_stype+fav_time, data=user.train[,-1], control = c5_options, rules=F)
summary(c5_model)
head(user.train)
c5_model <- C5.0(sex ~ mrg_flg+wk_pat+h_type1+h_type2+hobby+cus_stype+fav_time, data=user.train[,-1], control = c5_options, rules=F)
summary(c5_model)
summary(user_tree$wk_pat)
user_tree[user_tree$wk_pat=="유형없음",]
head(user_tree[user_tree$wk_pat=="유형없음",])
user_tree[user_tree$wk_pat=="유형없음",]$wk_pat <- "None"
user_tree[user_tree$wk_pat=="유형없음",]$wk_pat <- "NOWK"
user <- read.csv("2_group.csv", stringsAsFactors = T)
user <- user[,-c(3,4)]
user <- user[,-4]
user_tree <- user[,c(1:8,19,27,34:length(user))]
job <- read.delim("HDS_Jobs.tab",stringsAsFactors = T)
# 0 : 무효 1 : 남성 2: 여
user_tree = join(user_tree,job,by="job_stype")
user_tree <- user_tree[,-(length(user_tree)-1)]
user_tree <- user_tree[,-20]
user_tree <- user_tree[user_tree$sex!=0,] #무효는 제외
user_tree$sex <- factor(user_tree$sex)
user_tree$hobby <- factor(user_tree$hobby)
user_tree$job_stype <- factor(user_tree$job_stype)
user_tree$mail_flg <- factor(user_tree$mail_flg)
user_tree$h_type2 <- factor(user_tree$h_type2)
user_tree$card_flg1 <- factor(user_tree$card_flg1)
user_tree$mrg_flg <- factor(user_tree$mrg_flg)
user_tree$cus_stype <- factor(user_tree$cus_stype)
user_tree$agegrp <- factor(user_tree$agegrp)
user_tree[user_tree$wk_pat=="유형없음",]$wk_pat <- "NOWK"
head(user_tree)
user <- read.csv("2_group.csv", stringsAsFactors = T)
user <- user[,-c(3,4)]
user <- user[,-4]
user_tree <- user[,c(1:8,19,27,34:length(user))]
job <- read.delim("HDS_Jobs.tab",stringsAsFactors = T)
# 0 : 무효 1 : 남성 2: 여
user_tree = join(user_tree,job,by="job_stype")
user_tree <- user_tree[,-(length(user_tree)-1)]
user_tree <- user_tree[,-20]
user_tree <- user_tree[user_tree$sex!=0,] #무효는 제외
user_tree$sex <- factor(user_tree$sex)
user_tree$hobby <- factor(user_tree$hobby)
user_tree$job_stype <- factor(user_tree$job_stype)
user_tree$mail_flg <- factor(user_tree$mail_flg)
user_tree$h_type2 <- factor(user_tree$h_type2)
user_tree$card_flg1 <- factor(user_tree$card_flg1)
user_tree$mrg_flg <- factor(user_tree$mrg_flg)
user_tree$cus_stype <- factor(user_tree$cus_stype)
user_tree$agegrp <- factor(user_tree$agegrp)
user_tree[user_tree$wk_pat=="유형없음",]$wk_pat <- "dontknow"
user <- read.csv("2_group.csv", stringsAsFactors = T)
user <- user[,-c(3,4)]
user <- user[,-4]
user_tree <- user[,c(1:8,19,27,34:length(user))]
job <- read.delim("HDS_Jobs.tab",stringsAsFactors = T)
# 0 : 무효 1 : 남성 2: 여
user_tree = join(user_tree,job,by="job_stype")
user_tree <- user_tree[,-(length(user_tree)-1)]
user_tree <- user_tree[,-20]
user_tree <- user_tree[user_tree$sex!=0,] #무효는 제외
user_tree$sex <- factor(user_tree$sex)
user_tree$hobby <- factor(user_tree$hobby)
user_tree$job_stype <- factor(user_tree$job_stype)
user_tree$mail_flg <- factor(user_tree$mail_flg)
user_tree$h_type2 <- factor(user_tree$h_type2)
user_tree$card_flg1 <- factor(user_tree$card_flg1)
user_tree$mrg_flg <- factor(user_tree$mrg_flg)
user_tree$cus_stype <- factor(user_tree$cus_stype)
user_tree$agegrp <- factor(user_tree$agegrp)
summary(user_tree$wk_pat)
user_tree[user_tree$wk_pat=="주말형",]$wk_pat <- "weekend"
user <- read.csv("2_group.csv", stringsAsFactors = T)
user <- user[,-c(3,4)]
user <- user[,-4]
user_tree <- user[,c(1:8,19,27,34:length(user))]
job <- read.delim("HDS_Jobs.tab",stringsAsFactors = T)
# 0 : 무효 1 : 남성 2: 여
user_tree = join(user_tree,job,by="job_stype")
user_tree <- user_tree[,-(length(user_tree)-1)]
user_tree <- user_tree[,-20]
user_tree <- user_tree[user_tree$sex!=0,] #무효는 제외
user_tree$sex <- factor(user_tree$sex)
user_tree$hobby <- factor(user_tree$hobby)
user_tree$job_stype <- factor(user_tree$job_stype)
user_tree$mail_flg <- factor(user_tree$mail_flg)
user_tree$h_type2 <- factor(user_tree$h_type2)
user_tree$card_flg1 <- factor(user_tree$card_flg1)
user_tree$mrg_flg <- factor(user_tree$mrg_flg)
user_tree$cus_stype <- factor(user_tree$cus_stype)
user_tree$agegrp <- factor(user_tree$agegrp)
user <- read.csv("2_group.csv", stringsAsFactors = T)
user <- user[,-c(3,4)]
user <- user[,-4]
user_tree <- user[,c(1:8,19,27,34:length(user))]
job <- read.delim("HDS_Jobs.tab",stringsAsFactors = T)
# 0 : 무효 1 : 남성 2: 여
user_tree = join(user_tree,job,by="job_stype")
user_tree <- user_tree[,-(length(user_tree)-1)]
user_tree <- user_tree[,-20]
user_tree <- user_tree[user_tree$sex!=0,] #무효는 제외
user_tree$sex <- factor(user_tree$sex)
user_tree$hobby <- factor(user_tree$hobby)
user_tree$job_stype <- factor(user_tree$job_stype)
user_tree$mail_flg <- factor(user_tree$mail_flg)
user_tree$h_type2 <- factor(user_tree$h_type2)
user_tree$card_flg1 <- factor(user_tree$card_flg1)
user_tree$mrg_flg <- factor(user_tree$mrg_flg)
user_tree$cus_stype <- factor(user_tree$cus_stype)
user_tree$agegrp <- factor(user_tree$agegrp)
user_tree$wk_pat <- as.character(user_tree$wk_pat)
user_tree[user_tree$wk_pat="주말형",]$wk_pat <- "weekend"
user_tree[user_tree$wk_pat=="주말형",]$wk_pat <- "weekend"
user_tree[user_tree$wk_pat=="주중형",]$wk_pat <- "weekdays"
summary(user_tree$wk_pat)
head(user_tree[user_tree$wk_pat=="유형없음",])
user_tree[user_tree$wk_pat=="유형없음",]$wk_pat <- "none"
user_tree$wk_pat <- factor(user_tree$wk_pat)
summary(user_tree$wk_pat)
set.seed(1)
inTrain <- createDataPartition(y=user_tree$sex,p=0.6,list=F)
user.train <- user_tree[inTrain,]
user.test <- user_tree[-inTrain,]
dim(user.test)
dim(user.train)
c5_options <- C5.0Control(winnow = F, noGlobalPruning = F)
c5_model <- C5.0(sex ~ mrg_flg+wk_pat+h_type1+h_type2+hobby+cus_stype+fav_time, data=user.train[,-1], control = c5_options, rules=F)
summary(c5_model)
user.test$c5_pred <- predict(c5_model,user.test,type="class")
confusionMatrix(user.test$c5_pred, user.test$sex)
