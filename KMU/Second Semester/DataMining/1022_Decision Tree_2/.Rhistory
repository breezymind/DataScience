install.packages("C50")
install.packages("caret")
install.packages("ROCR")
install.packages("C50")
install.packages("C50")
install.packages("caret")
install.packages("ROCR")
library(C50)
library(caret)
library(ROCR)
vb <- read.delim("Hshopping.txt",stringsAsFactors = F)
sb <- read.delim("Hshopping.txt",stringsAsFactors = F)
sb
head(sb)
str(sb)
View(vb)
rm(vb)
cb <- read.delim("Hshopping.txt",stringsAsFactors = F)
head(cb)
str(cb)
rm(sb)
cb$반품여부 <- as.factor(cb$반품여부)
str(cb)
summary(cb)
inTrain <- createDataPartition(y=cb$반품여부,p=0.6,list=F)
head(inTrain)
head(inTrain)
set.seed(1) # seed를 고정해야 동일한 샘플링을 가질 수 있다.
inTrain <- createDataPartition(y=cb$반품여부,p=0.6,list=F)
head(inTrain)
cb.train <- cb[inTrain,]
head(cb.train)
cb.test <- cb[-inTrain,]
head(cb.test)
dim(cb.test)
dim(cb.train)
c5_model <- c5.0(반품여부 ~ 성별+나이+구매금액+출연자, data=cb.train, control = c5_options, rules=F)
plot(c5_model)
c5_model <- c5.0(반품여부 ~ 성별+나이+구매금액+출연자, data=cb.train, control = c5_options, rules=F)
c5_model <- c5.0(반품여부 ~ 성별+나이+구매금액+출연자, data=cb.train, control = c5_options, rules=F)
c5_model <- C5.0(반품여부 ~ 성별+나이+구매금액+출연자, data=cb.train, control = c5_options, rules=F)
c5_options <- C5.0Control(winnow = F, noGlobalPruning = F)
c5_model <- C5.0(반품여부 ~ 성별+나이+구매금액+출연자, data=cb.train, control = c5_options, rules=F)
plot(c5_model)
summary(c5_model)
c5_model_2 <- C5.0(반품여부 ~ 성별+나이+구매금액+출연자, data=cb.train, control = c5_options, rules=T)
summary(c5_model_2)
c5_model_3 <- C5.0(반품여부 ~ 성별+나이+구매금액+출연자, data=cb.train, control = c5_options, rules=F, trials = 10)
summary(c5_model_3)
c5_model_3 <- C5.0(반품여부 ~ 성별+나이+구매금액+출연자, data=cb.train, control = c5_options, rules=T, trials = 10)
summary(c5_model_3)
c5_options_2 <- C5.0Control(winnow = F, noGlobalPruning = F, CF=0.7)
c5_model_4 <- C5.0(반품여부 ~ 성별+나이+구매금액+출연자, data=cb.train, control = c5_options_2, rules=T, trials = 10)
c5_model_4 <- C5.0(반품여부 ~ 성별+나이+구매금액+출연자, data=cb.train, control = c5_options_2, rules=T, c5_model_3 <- C5.0(반품여부 ~ 성별+나이+구매금액+출연자, data=cb.train, control = c5_options, rules=F)
)
c5_model_4 <- C5.0(반품여부 ~ 성별+나이+구매금액+출연자, data=cb.train, control = c5_options_2, rules=T, c5_model_3 <- C5.0(반품여부 ~ 성별+나이+구매금액+출연자, data=cb.train, control = c5_options, rules=F)
c5_model_4 <- C5.0(반품여부 ~ 성별+나이+구매금액+출연자, data=cb.train, control = c5_options_2, rules=F)
c5_options_2 <- C5.0Control(winnow = F, noGlobalPruning = F, CF=0.7)
c5_model_4 <- C5.0(반품여부 ~ 성별+나이+구매금액+출연자, data=cb.train, control = c5_options_2, rules=F)
summary(c5_model_4)
plot(c5_model_4)
cb.test$c5_pred <- predict(c5_model,cb.test,type="class")
head(cb.test)
confusionMatrix(cb.test[,6:7])
confusionMatrix(cb.test$반품여부, cb.test$c5_pred)
cb.test$c5_pred_prob <- predict(c5_model,cb.test,type="prob")
head(cb.test)
cb.test$c5_pred_prob <- round(predict(c5_model,cb.test,type="prob"),2)
head(cb.test)
confusionMatrix(cb.test$c5_pred, cb.test$반품여부)
c5_pred <- prediction(cb.test$c5_pred_prob[,2], cb.test$반품여부)
head(c5_pred)
summary(c5_pred)
c5_model.perf1 <- performance(c5_pred,"tpr","fpr") # Roc curve
c5_model.perf2 <- performance(c5_pred,"lift","rpp") # Lift chart
par(mfow=c(1,2))
?par
par(mfrow=c(1,2))
plot(c5_model.perf1,colorize=T)
plot(c5_model.perf2,colorize=T)
performance(c5_pred,"auc")@y.values[[1]]
install.packages("Epi")
library(Epi)
library(psych)
pairs.panels(cb.test)
pairs.panels(cb)
install.packages("C50")
install.packages("caret")
install.packages("ROCR")
install.packages("Epi")
ROC(form=cb.test$반품여부~c5_pred_prob[,2],)
pairs.panels(cb)
library(psych)
pairs.panels(cb)
